/* 새로운 Whats Section Component - 겹치는 레이어 구조 */

.main-screen__container {
    position: relative;
    width: 100%;
    height: calc(100vh - 60px); /* 헤더 높이를 뺀 전체 화면 높이 */
    overflow: hidden; /* 슬라이드 효과를 위해 */
    perspective: 1500px; /* 더 강한 3D 효과 */
    perspective-origin: center center;
    transform-style: preserve-3d;
    z-index: 10;
}

/* 모든 섹션을 같은 위치에 겹치게 배치 */
.whats-section {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%; /* 부모 컨테이너(calc(100vh - 60px))에 맞춤 */
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
}

/* 3D 큐브 전환 중 그림자 효과 */
.whats-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        rgba(0, 0, 0, 0.3) 0%, 
        transparent 50%, 
        rgba(0, 0, 0, 0.3) 100%);
    opacity: 0;
    z-index: 10;
    pointer-events: none;
    transition: opacity 1.4s ease-out;
}

/* 3D 회전 중일 때 그림자 표시 */
.whats-section.cube-rotate-out::before,
.whats-section.cube-rotate-in::before {
    opacity: 1;
}

/* intro 섹션 - 처음에는 숨김 */
.whats-section--intro {
    z-index: 15;
    transform: translateZ(0);
    opacity: 0; /* 처음에는 숨김 */
    transform-style: preserve-3d;
    transform-origin: center center; /* 중앙 기준으로 회전 */
    backface-visibility: hidden; /* 뒷면 숨김 */
    will-change: transform, opacity;
}

/* intro 섹션이 활성화되었을 때 */
.whats-section--intro.active {
    opacity: 1;
    transform: translateZ(0) rotateY(0deg);
}

/* intro 섹션 3D 큐브 전환 - 왼쪽으로 회전하면서 페이드아웃 */
.whats-section--intro.cube-rotate-out {
    transform-origin: left center; /* 순방향은 왼쪽 기준 */
    transform: translateX(-100px) translateZ(-300px) rotateY(-95deg) scale(0.75);
    opacity: 0;
    z-index: 1;
    pointer-events: none;
    filter: brightness(0.6) saturate(0.8);
    transition: transform 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                opacity 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                filter 1.4s ease-out;
}

/* intro 섹션이 완전히 비활성화되었을 때 - 왼쪽 회전 위치에서 대기 (수정됨) */
.whats-section--intro.deactivated {
    transform-origin: left center; /* 역방향 대기도 왼쪽 기준 */
    transform: translateX(-100px) translateZ(-300px) rotateY(-95deg) scale(0.75);
    opacity: 0;
    z-index: 1;
    pointer-events: none;
    filter: brightness(0.6) saturate(0.8);
    /* 역방향 전환을 위해 콘텐츠 유지 */
    will-change: transform, opacity, z-index;
}

/* 3D 큐브 역전환 - middle에서 intro로 돌아올 때 (수정됨) */
.whats-section--intro.cube-rotate-in {
    z-index: 15 !important; /* !important로 강제 우선순위 */
    pointer-events: auto;
    transform-origin: left center; /* 역방향도 왼쪽 기준으로 회전 */
    /* 콘텐츠 가시성 보장 */
    opacity: 1 !important;
    visibility: visible !important;
    /* transition 제거 - animation과 충돌 방지 */
    animation: intro-cube-rotate-in 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* intro 섹션 3D 큐브 회전 애니메이션 (수정됨) */
@keyframes intro-cube-rotate-in {
    0% { 
        transform: translateX(-100px) translateZ(-300px) rotateY(-95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
    }
    100% { 
        transform: translateZ(0) rotateY(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
}

/* 첫 번째 섹션 - 두 번째 레이어 */
.whats-section--first {
    z-index: 10;
    transform: translateY(0);
    opacity: 0; /* intro 다음에 나타남 */
}

/* 첫 번째 섹션이 intro 다음에 나타날 때 */
.whats-section--first.fade-in-from-intro {
    opacity: 1;
}

/* 두 번째 섹션 - 뒤 레이어 */
.whats-section--second {
    z-index: 5;
    transform: translateY(0);
    opacity: 0; /* 처음에는 투명 */
}

/* 세 번째 섹션 - 맨 뒤 레이어 (초기 상태: 아래에서 회전) */
.whats-section--third {
    z-index: 3;
    transform: translateY(100px) translateZ(-300px) rotateX(-95deg) scale(0.75);
    opacity: 0; /* 처음에는 숨김 */
    transform-style: preserve-3d;
    transform-origin: center bottom; /* 아래쪽을 기준으로 회전 */
    backface-visibility: hidden; /* 뒷면 숨김 */
    will-change: transform, opacity;
    filter: brightness(0.6) saturate(0.8);
}

/* 세 번째 섹션 3D 큐브 전환 - 아래에서 회전하면서 나타남 */
.whats-section--third.cube-rotate-in {
    z-index: 6 !important; /* second보다 높게 설정 */
    pointer-events: auto;
    /* 콘텐츠 가시성 보장 */
    opacity: 1 !important;
    visibility: visible !important;
    /* transition 제거 - animation과 충돌 방지 */
    animation: third-cube-rotate-in 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* 세 번째 섹션 3D 큐브 역전환 - 아래로 회전하면서 사라짐 */
.whats-section--third.cube-rotate-out {
    /* transition 제거 - animation과 충돌 방지 */
    animation: third-cube-rotate-out 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* third 섹션 3D 큐브 회전 인 애니메이션 */
@keyframes third-cube-rotate-in {
    0% { 
        transform: translateY(100px) translateZ(-300px) rotateX(-95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
    }
    100% { 
        transform: translateZ(0) rotateX(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
}

/* third 섹션 3D 큐브 회전 아웃 애니메이션 */
@keyframes third-cube-rotate-out {
    0% { 
        transform: translateZ(0) rotateX(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
    100% { 
        transform: translateY(100px) translateZ(-300px) rotateX(-95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
    }
}

/* 두 번째 섹션이 위로 회전하면서 사라지는 효과 (second → third 전환 시) */
.whats-section--second.cube-rotate-out-up {
    transform-origin: center top; /* 위쪽을 기준으로 회전 */
    /* transition 제거 - animation과 충돌 방지 */
    animation: second-cube-rotate-out-up 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* second 섹션이 위로 회전하면서 사라지는 애니메이션 */
@keyframes second-cube-rotate-out-up {
    0% { 
        transform: translateZ(0) rotateX(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
    100% { 
        transform: translateY(-100px) translateZ(-300px) rotateX(95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
        z-index: 1;
        pointer-events: none;
    }
}

/* 두 번째 섹션이 아래에서 회전하면서 나타나는 효과 (third → second 역전환 시) */
.whats-section--second.cube-rotate-in-down {
    z-index: 5 !important; /* !important로 강제 우선순위 */
    pointer-events: auto;
    transform-origin: center top; /* 위쪽을 기준으로 회전 */
    /* 콘텐츠 가시성 보장 */
    opacity: 1 !important;
    visibility: visible !important;
    /* transition 제거 - animation과 충돌 방지 */
    animation: second-cube-rotate-in-down 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* second 섹션이 아래에서 회전하면서 나타나는 애니메이션 */
@keyframes second-cube-rotate-in-down {
    0% { 
        transform: translateY(-100px) translateZ(-300px) rotateX(95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
    }
    100% { 
        transform: translateZ(0) rotateX(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
}

/* 슬라이드 아웃 상태 (기존 first → second 전환용) */
.whats-section--first.slide-out {
    transform: translateY(-100%);
    opacity: 0;
}

/* 페이드 인 상태 (기존 first → second 전환용) */
.whats-section--second.fade-in {
    opacity: 1;
}

/* Wheel Move Container - intro 섹션용 */
.wheel-move-container {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
    z-index: 2; /* 배경 위에 위치 */
    /* 콘텐츠 가시성 보장 */
    will-change: opacity, visibility;
}

/* intro 섹션이 비활성화되었을 때 wheel container 숨김 방지 */
.whats-section--intro.deactivated .wheel-move-container {
    opacity: 1; /* 역방향 전환을 위해 유지 */
    visibility: visible;
}

/* Wheel 이미지 기본 설정 */
.wheel-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    visibility: hidden;
    /* transition 제거 - 즉시 전환으로 깜빡거림 방지 */
    /* 메모리 최적화 */
    will-change: opacity, visibility;
}

/* 활성화된 wheel 이미지 */
.wheel-image.active {
    opacity: 1;
    visibility: visible;
}

/* 섹션별 배경색 */
.whats-section__bg {
    position: absolute;
    inset: 0;
    z-index: 1;
    width: 100%;
    height: 100%;
}

.bg-1 {
    background-color: var(--color-yellow);
    position: relative;
    overflow: hidden;
}

.bg-2 {
    background-color: var(--spectrum-20);
}

.bg-3 {
    background-color: var(--color-blue);
}

.bg-intro {
    background-color: var(--color-blue);
}

/* 타이틀 컨테이너 */
.whats-section__content {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    z-index: 10; /* 격자보다 위 */
    pointer-events: none; /* 격자 클릭 방해 안하도록 */
}

/* third 섹션의 content는 세로 배치 */
.whats-section--third .whats-section__content {
    flex-direction: column;
    gap: 60px; /* 타이틀과 버튼 사이 간격 */
}

.whats-section__content * {
    pointer-events: auto; /* 콘텐츠는 클릭 가능하게 */
}

.whats-section__title {
    font-weight: 700;
    font-size: 3rem;
    text-align: center;
    line-height: 1.2;
    color: #ffffff;
    transform: translateY(-20%);
    z-index: 4;
}

/* third 섹션의 타이틀은 transform 제거 (flexbox로 정렬) */
.whats-section--third .whats-section__title {
    transform: none;
}

/* 폴짝 점프 + 손흔들기 텍스트 효과 */
@keyframes jump-then-wave {
    0% { transform: translateY(0) rotate(0deg) scale(1); }
    10% { transform: translateY(-40px) rotate(0deg) scale(1.4); } /* 높이 폴짝! */
    25% { transform: translateY(0) rotate(0deg) scale(1); }      /* 착지 */
    35% { transform: translateY(0) rotate(25deg) scale(1); }     /* 손흔들기 시작 */
    42% { transform: translateY(0) rotate(-20deg) scale(1); }
    49% { transform: translateY(0) rotate(18deg) scale(1); }
    56% { transform: translateY(0) rotate(-15deg) scale(1); }
    63% { transform: translateY(0) rotate(12deg) scale(1); }
    70% { transform: translateY(0) rotate(-8deg) scale(1); }
    77% { transform: translateY(0) rotate(5deg) scale(1); }
    84% { transform: translateY(0) rotate(-3deg) scale(1); }
    91% { transform: translateY(0) rotate(1deg) scale(1); }
    100% { transform: translateY(0) rotate(0deg) scale(1); }
  }

.whats-section__description {
    font-weight: 100;
    font-size: 1rem;
    text-align: center;
    line-height: 1.2;
    color: #ffffff;
    display: inline-block; /* transform 작동을 위해 필요 */
    transform-origin: bottom center; /* 흔들리는 중심점 */
}

/* first 섹션이 활성화되었을 때만 애니메이션 실행 */
.whats-section--first.fade-in-from-intro .whats-section__description {
    animation: jump-then-wave 3s ease-in-out infinite;
    animation-delay: 0.5s; /* 섹션 전환 후 0.5초 뒤에 시작 */
}

/* 스크롤 화살표 - intro 섹션 제외 */
.whats-section:not(.whats-section--intro) .scroll-arrow__container {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 15;
}

.scroll-arrow__wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.scroll-arrow__icon {
    color: #ffffff;
    opacity: 0.8;
    transition: opacity 0.3s ease;
}


/* Intro Bottom UI Container - wheel-progress-bar와 scroll-arrow__container를 같은 레벨로 관리 */
.intro-bottom-ui {
    position: absolute;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column; /* 순서 그대로: wheel-progress-bar 위, scroll-arrow 아래 */
    align-items: center;
    gap: 20px;
    z-index: 15;
    opacity: 0;
    transition: opacity 0.3s ease;
}

/* intro 섹션이 활성화되었을 때 하단 UI 표시 */
.whats-section--intro.active .intro-bottom-ui {
    opacity: 1;
}

/* Wheel Progress Bar - 이미지 전환 상태바 (수정됨) */
.wheel-progress-bar {
    position: relative; /* fill의 absolute 위치 기준 */
    width: 300px;
    height: 4px;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
    overflow: hidden;
}

.wheel-progress-bar__fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 0.76%; /* 1/132 = 0.76% */
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 2px;
    transition: width 0.3s ease, background-color 0.3s ease;
}

/* 마지막 이미지에 도달했을 때 파란색으로 변경 */
.wheel-progress-bar__fill.complete {
    background-color: var(--color-point);
}

/* intro 섹션의 scroll-arrow__icon */
.intro-bottom-ui .scroll-arrow__icon {
    color: whitesmoke;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 50px;
    height: 50px;
    background: rgba(96, 165, 250, 0.1);
    border: 2px solid rgba(96, 165, 250, 0.3);
    border-radius: 50%;
    transition: all 0.3s ease;
    animation: bounceUpDown 2s ease-in-out infinite;
}

/* intro 섹션의 scroll-arrow__text */
.intro-bottom-ui .scroll-arrow__text {
    color: whitesmoke;
    font-size: 1.5rem;
    font-weight: 400;
    text-align: center;
    transition: all 0.3s ease;
}


/* 이미지 깜박거림 방지 - 강제 설정 */
.wheel-image {
    transition: none !important;
    transform: translateZ(0) !important;
    backface-visibility: hidden !important;
}

.wheel-image.active {
    opacity: 1 !important;
    visibility: visible !important;
    transition: none !important;
}

/* bounceUpDown 애니메이션 정의 */
@keyframes bounceUpDown {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-8px);
    }
}

/* 모바일 대응 */
@media (max-width: 768px) {
    .intro-bottom-ui {
        bottom: 30px;
        gap: 16px;
    }
    
    .wheel-progress-bar {
        width: 250px;
    }
}

@media (max-width: 480px) {
    .intro-bottom-ui {
        bottom: 20px;
        gap: 12px;
    }
    
    .wheel-progress-bar {
        width: 200px;
    }
}

/* 중간 섹션 - intro와 first 사이 (초기 상태: 오른쪽으로 회전) */
.whats-section--middle {
    z-index: 12;
    transform: translateX(100px) translateZ(-300px) rotateY(95deg) scale(0.75);
    opacity: 0; /* 처음에는 숨김 */
    transform-style: preserve-3d;
    transform-origin: right center; /* 오른쪽을 기준으로 회전 */
    backface-visibility: hidden; /* 뒷면 숨김 */
    will-change: transform, opacity;
    filter: brightness(0.6) saturate(0.8);
}

/* 중간 섹션 3D 큐브 전환 - 오른쪽에서 회전하면서 나타남 */
.whats-section--middle.cube-rotate-in {
    transform: translateZ(0) rotateY(0deg) scale(1);
    opacity: 1;
    filter: brightness(1);
    transition: transform 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                opacity 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                filter 1.4s ease-out;
}

/* 중간 섹션 3D 큐브 역전환 - 오른쪽으로 회전하면서 사라짐 */
.whats-section--middle.cube-rotate-out {
    /* transition 제거 - animation과 충돌 방지 */
    animation: middle-cube-rotate-out 1.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

/* middle 섹션 3D 큐브 회전 아웃 애니메이션 */
@keyframes middle-cube-rotate-out {
    0% { 
        transform: translateZ(0) rotateY(0deg) scale(1);
        opacity: 1;
        filter: brightness(1);
    }
    100% { 
        transform: translateX(100px) translateZ(-300px) rotateY(95deg) scale(0.75);
        opacity: 0;
        filter: brightness(0.6) saturate(0.8);
    }
}

/* 중간 섹션 배경 */
.bg-middle {
    background-color: var(--spectrum-20);
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
}

/* 중간 섹션 슬라이드 아웃 (middle → first 전환용) */
.whats-section--middle.slide-out {
    transform: translateY(-100%);
    opacity: 0;
}

/* middle 섹션 타이틀 글자별 애니메이션 */
.whats-section--middle .whats-section__title {
    perspective: 1000px; /* 3D 효과를 위한 원근감 */
    text-align: center; /* 중앙 정렬 강제 */
    white-space: nowrap; /* 줄바꿈 방지 */
}

/* 개별 글자 초기 상태 */
.whats-section--middle .title-char {
    display: inline-block;
    opacity: 0;
    transform: translateY(50px) rotateX(-90deg);
    transform-origin: center bottom;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
    animation-duration: 0.5s; /* 0.6초에서 0.5초로 단축 */
}

/* 공백 문자 처리 */
.whats-section--middle .title-char.space {
    width: 0.5em; /* 공백 너비 */
}

/* 글자별 등장 애니메이션 */
@keyframes charReveal {
    0% {
        opacity: 0;
        transform: translateY(50px) rotateX(-90deg);
    }
    100% {
        opacity: 1;
        transform: translateY(0) rotateX(0);
    }
}

/* 애니메이션 트리거 클래스 */
.whats-section--middle.title-animated .title-char {
    animation-name: charReveal;
}

/* second 섹션 마우스 따라다니는 타이틀 */
.whats-section--second .whats-section__title {
    position: fixed;
    z-index: 1000;
    pointer-events: none;
    transition: transform 0.1s ease-out, color 0.2s ease;
    transform-origin: center center;
    will-change: transform, color;
    font-weight: 700;
    font-size: 3rem;
    text-align: center;
    line-height: 1.2;
    white-space: nowrap;
}

/* second 섹션이 활성화되었을 때만 마우스 따라다니기 활성화 */
.whats-section--second.fade-in .whats-section__title {
    /* 마우스 추적 활성화됨 - JavaScript에서 제어 */
}

/* third 섹션 네온 글로우 + 물결 효과 타이틀 */
.whats-section--third .whats-section__title {
    font-weight: 700;
    position: relative;
    display: inline-block;
}

/* 네온 글로우 + 물결 효과를 위한 개별 글자 스타일 */
.neon-wave-letter {
    display: inline-block;
    color: #fff;
    text-shadow: 
        0 0 5px #fff,
        0 0 10px #fff,
        0 0 15px #0073e6,
        0 0 20px #0073e6,
        0 0 35px #0073e6,
        0 0 40px #0073e6;
    animation: 
        wave 2s ease-in-out infinite,
        neonFlicker 2s ease-in-out infinite alternate;
    transform-origin: center bottom;
}

/* 물결 효과 애니메이션 */
@keyframes wave {
    0%, 100% {
        transform: translateY(0px);
    }
    50% {
        transform: translateY(-20px);
    }
}

/* 네온 글로우 깜박임 효과 */
@keyframes neonFlicker {
    0% {
        text-shadow: 
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 15px #0073e6,
            0 0 20px #0073e6,
            0 0 35px #0073e6,
            0 0 40px #0073e6;
    }
    100% {
        text-shadow: 
            0 0 2px #fff,
            0 0 5px #fff,
            0 0 8px #0073e6,
            0 0 12px #0073e6,
            0 0 20px #0073e6,
            0 0 25px #0073e6;
    }
}
